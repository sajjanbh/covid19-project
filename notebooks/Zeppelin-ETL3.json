{"paragraphs":[{"text":"%pyspark\nfrom pyspark.sql import SparkSession\nfrom datetime import datetime, timedelta","user":"anonymous","dateUpdated":"2020-10-30T23:28:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1604097509640_1563557398","id":"20201030-223829_512956114","dateCreated":"2020-10-30T22:38:29+0000","dateStarted":"2020-10-30T23:28:15+0000","dateFinished":"2020-10-30T23:28:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4655"},{"text":"%pyspark\n# Define date\nyear = \"2020\"\nmonth = \"10\"\nday = \"30\"","user":"anonymous","dateUpdated":"2020-10-30T23:28:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1604097516404_-1351494910","id":"20201030-223836_872768635","dateCreated":"2020-10-30T22:38:36+0000","dateStarted":"2020-10-30T23:28:16+0000","dateFinished":"2020-10-30T23:28:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4656"},{"text":"%pyspark\nmy_bucket = \"<your-bucket-name>\"\ndatabase = \"emr_project\"\netl1_table = \"{}.etl1_aggregated_v2\".format(database)\netl2_table = \"{}.covid_twitter_etl2_v2\".format(database)\noutput_path = \"s3://{}/notebook/covid_etl3/\".format(my_bucket)\noutput_table = \"{}.covid_etl3_ntbk_v2\".format(database)","user":"anonymous","dateUpdated":"2020-10-30T23:28:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1604097617172_-1096513838","id":"20201030-224017_1420075913","dateCreated":"2020-10-30T22:40:17+0000","dateStarted":"2020-10-30T23:28:16+0000","dateFinished":"2020-10-30T23:28:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4657"},{"text":"%pyspark\n# Process data from yesterday (Tuesday) to last Wednesday\ndt = \"{}-{}-{}\".format(year, month, day)\nthis_day = datetime.strptime(dt, \"%Y-%m-%d\")\ntues = this_day - timedelta(days=1)\nlast_wed = this_day - timedelta(days=7)\n\nyesterday = tues.strftime(\"%Y-%m-%d\")\nthat_day = last_wed.strftime(\"%Y-%m-%d\")\nprocessed_days = []","user":"anonymous","dateUpdated":"2020-10-30T23:28:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1604097643821_-1185922617","id":"20201030-224043_540352170","dateCreated":"2020-10-30T22:40:43+0000","dateStarted":"2020-10-30T23:28:16+0000","dateFinished":"2020-10-30T23:28:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4658"},{"text":"%pyspark\n# Function to generate proper WHERE clause to query 7 days worth of data from ETL1 and ETL2 output. This logic may not be required if running every day.\ndef get_where_clause():\n    # Prepare a WHERE clause for ETL1 data based on month and day values for last week\n    m_d = {}\n    for i in range(7):\n        d = tues - timedelta(days=i)\n        # Add day to processed_days list\n        processed_days.append({'S': d.strftime(\"%Y-%m-%d\")})\n\n        m = '{}-{}'.format(d.year, \"{0:0=2d}\".format(d.month))\n        if m not in m_d: m_d[m] = [\"{0:0=2d}\".format(d.day)]\n        else: m_d[m].append(\"{0:0=2d}\".format(d.day))\n\n    conditions = []\n    for m, d in m_d.items():\n        conditions.append('month = \"{}\" AND day IN (\"{}\")'.format(m, '\", \"'.join(d)))\n\n    return '({})'.format(') OR ('.join(conditions))","user":"anonymous","dateUpdated":"2020-10-30T23:28:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1604097654798_-480587739","id":"20201030-224054_1470870474","dateCreated":"2020-10-30T22:40:54+0000","dateStarted":"2020-10-30T23:28:16+0000","dateFinished":"2020-10-30T23:28:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4659"},{"text":"%pyspark\n# Create Session\nspark = SparkSession \\\n    .builder \\\n    .appName(\"ETL3 - Join Github and Twitter data\") \\\n    .enableHiveSupport() \\\n    .config(\"spark.hadoop.mapreduce.input.fileinputformat.input.dir.recursive\",\"true\") \\\n    .config(\"hive.mapred.supports.subdirectories\",\"true\") \\\n    .getOrCreate()","user":"anonymous","dateUpdated":"2020-10-30T23:28:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1604097665058_-1123468182","id":"20201030-224105_1378510571","dateCreated":"2020-10-30T22:41:05+0000","dateStarted":"2020-10-30T23:28:16+0000","dateFinished":"2020-10-30T23:28:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4660"},{"text":"%pyspark\n# Create a Dataframe from ETL-2 results (Twitter data)\nq1 = 'select country, cast(day as date), numberofcovidtweetsretrieved as numberofcovidtweetsretrieved from {} where country != \"\" AND cast(day as date) between cast(\"{}\" as date) and cast(\"{}\" as date)'.format(etl2_table, that_day, yesterday)\ndf1 = spark.sql(q1)\ndf1.show(4)","user":"anonymous","dateUpdated":"2020-10-30T23:28:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----------+----------------------------+\n|country|       day|numberofcovidtweetsretrieved|\n+-------+----------+----------------------------+\n|     DZ|2020-10-28|                           2|\n|     CI|2020-10-28|                           1|\n|     FI|2020-10-28|                           7|\n|     AZ|2020-10-28|                           5|\n+-------+----------+----------------------------+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1604097672721_1558686901","id":"20201030-224112_2103678884","dateCreated":"2020-10-30T22:41:12+0000","dateStarted":"2020-10-30T23:28:16+0000","dateFinished":"2020-10-30T23:28:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4661"},{"text":"%pyspark\n# Create a Dataframe from ETL-1 results (Github data)\nq2 = 'select country, cast(concat(month, \"-\", day) as date) as dt, sum(confirmed) as confirmed, sum(deaths) as deaths, sum(recovered) as recovered from {} where {} group by country, dt'.format(etl1_table, get_where_clause())\ndf2 = spark.sql(q2)\ndf2.show(4)","user":"anonymous","dateUpdated":"2020-10-30T23:28:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----------+---------+------+---------+\n|country|        dt|confirmed|deaths|recovered|\n+-------+----------+---------+------+---------+\n|     TR|2020-10-25|   361801|  9799|   314390|\n|     UG|2020-10-29|    12201|   108|     7461|\n|     MZ|2020-10-25|    11986|    86|     9253|\n|     ER|2020-10-26|      461|     0|      405|\n+-------+----------+---------+------+---------+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1604097681388_-385849645","id":"20201030-224121_668884918","dateCreated":"2020-10-30T22:41:21+0000","dateStarted":"2020-10-30T23:28:27+0000","dateFinished":"2020-10-30T23:28:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4662"},{"text":"%pyspark\n# Join above two dataframes \ndf3 = df2.join(df1, (df1.country == df2.country) & (df1.day == df2.dt)).select(df1.country, df1.day, df1.numberofcovidtweetsretrieved, df2.confirmed, df2.deaths, df2.recovered)\ndf3.persist()","user":"anonymous","dateUpdated":"2020-10-30T23:28:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[country: string, day: date, numberofcovidtweetsretrieved: int, confirmed: bigint, deaths: bigint, recovered: bigint]\n"}]},"apps":[],"jobName":"paragraph_1604097702991_-128785600","id":"20201030-224142_647624372","dateCreated":"2020-10-30T22:41:42+0000","dateStarted":"2020-10-30T23:28:56+0000","dateFinished":"2020-10-30T23:28:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4663"},{"text":"%pyspark\ndf3.createOrReplaceTempView(\"final\")","user":"anonymous","dateUpdated":"2020-10-30T23:28:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1604097710423_-1475419533","id":"20201030-224150_1296279729","dateCreated":"2020-10-30T22:41:50+0000","dateStarted":"2020-10-30T23:28:57+0000","dateFinished":"2020-10-30T23:28:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4664"},{"text":"%sql\nselect day, country, confirmed from (\n    select *, row_number() OVER (PARTITION BY day ORDER BY confirmed DESC, numberofcovidtweetsretrieved DESC) rn from final\n)\nwhere rn <= 10","user":"anonymous","dateUpdated":"2020-10-30T23:31:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":717.267,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"country":"string","day":"string","numberofcovidtweetsretrieved":"string","confirmed":"string","deaths":"string","recovered":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","lineWithFocus":true,"isDateFormat":false,"forceY":true}},"commonSetting":{},"keys":[{"name":"day","index":0,"aggr":"sum"}],"groups":[{"name":"country","index":1,"aggr":"sum"}],"values":[{"name":"confirmed","index":2,"aggr":"avg"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"day\tcountry\tconfirmed\n2020-10-29\tUS\t8944934\n2020-10-29\tIN\t8088851\n2020-10-29\tBR\t5494376\n2020-10-29\tRU\t1570446\n2020-10-29\tFR\t1327852\n2020-10-29\tES\t1160083\n2020-10-29\tAR\t1143800\n2020-10-29\tCO\t1048055\n2020-10-29\tGB\t968456\n2020-10-29\tMX\t912811\n2020-10-28\tUS\t8856413\n2020-10-28\tIN\t8040203\n2020-10-28\tBR\t5468270\n2020-10-28\tRU\t1553028\n2020-10-28\tFR\t1280215\n2020-10-28\tES\t1136503\n2020-10-28\tAR\t1130533\n2020-10-28\tCO\t1041936\n2020-10-28\tGB\t945378\n2020-10-28\tMX\t906863\n2020-10-25\tUS\t8635966\n2020-10-25\tIN\t7909959\n2020-10-25\tBR\t5380635\n2020-10-25\tRU\t1503652\n2020-10-25\tFR\t1130143\n2020-10-25\tAR\t1090589\n2020-10-25\tES\t1046132\n2020-10-25\tCO\t1015885\n2020-10-25\tMX\t891160\n2020-10-25\tPE\t888715\n2020-10-24\tUS\t8575177\n2020-10-24\tIN\t7864811\n2020-10-24\tBR\t5380635\n2020-10-24\tRU\t1487260\n2020-10-24\tFR\t1084659\n2020-10-24\tAR\t1081336\n2020-10-24\tES\t1046132\n2020-10-24\tCO\t1007711\n2020-10-24\tMX\t886800\n2020-10-24\tPE\t883116\n2020-10-23\tUS\t8491459\n2020-10-23\tIN\t7814682\n2020-10-23\tBR\t5353656\n2020-10-23\tRU\t1471000\n2020-10-23\tFR\t1084659\n2020-10-23\tAR\t1069368\n2020-10-23\tES\t1046132\n2020-10-23\tCO\t998942\n2020-10-23\tMX\t880775\n2020-10-23\tPE\t879876\n2020-10-27\tUS\t8777432\n2020-10-27\tIN\t7946429\n2020-10-27\tBR\t5439641\n2020-10-27\tRU\t1537142\n2020-10-27\tFR\t1244242\n2020-10-27\tES\t1116738\n2020-10-27\tAR\t1116609\n2020-10-27\tCO\t1033218\n2020-10-27\tGB\t920664\n2020-10-27\tMX\t901268\n2020-10-26\tUS\t8702750\n2020-10-26\tIN\t7946429\n2020-10-26\tBR\t5409854\n2020-10-26\tRU\t1520800\n2020-10-26\tFR\t1209651\n2020-10-26\tAR\t1102301\n2020-10-26\tES\t1098320\n2020-10-26\tCO\t1025052\n2020-10-26\tGB\t897740\n2020-10-26\tMX\t895326\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1604098184283_-1249013354","id":"20201030-224944_1487129376","dateCreated":"2020-10-30T22:49:44+0000","dateStarted":"2020-10-30T23:31:27+0000","dateFinished":"2020-10-30T23:32:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4665"},{"text":"%sql\nselect day, country, deaths from (\n    select *, row_number() OVER (PARTITION BY day ORDER BY confirmed DESC, numberofcovidtweetsretrieved DESC) rn from final\n)\nwhere rn <= 10","user":"anonymous","dateUpdated":"2020-10-30T23:31:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":779.267,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"country":"string","day":"string","numberofcovidtweetsretrieved":"string","confirmed":"string","deaths":"string","recovered":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","lineWithFocus":true,"isDateFormat":false,"forceY":true}},"commonSetting":{},"keys":[{"name":"day","index":0,"aggr":"sum"}],"groups":[{"name":"country","index":1,"aggr":"sum"}],"values":[{"name":"deaths","index":2,"aggr":"avg"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"day\tcountry\tdeaths\n2020-10-29\tUS\t228656\n2020-10-29\tIN\t121090\n2020-10-29\tBR\t158969\n2020-10-29\tRU\t27111\n2020-10-29\tFR\t36058\n2020-10-29\tES\t35639\n2020-10-29\tAR\t30442\n2020-10-29\tCO\t30926\n2020-10-29\tGB\t46045\n2020-10-29\tMX\t90773\n2020-10-28\tUS\t227685\n2020-10-28\tIN\t120527\n2020-10-28\tBR\t158456\n2020-10-28\tRU\t26752\n2020-10-28\tFR\t35823\n2020-10-28\tES\t35466\n2020-10-28\tAR\t30071\n2020-10-28\tCO\t30753\n2020-10-28\tGB\t45765\n2020-10-28\tMX\t90309\n2020-10-25\tUS\t225229\n2020-10-25\tIN\t119014\n2020-10-25\tBR\t156903\n2020-10-25\tRU\t25875\n2020-10-25\tFR\t34673\n2020-10-25\tAR\t28896\n2020-10-25\tES\t34752\n2020-10-25\tCO\t30000\n2020-10-25\tMX\t88924\n2020-10-25\tPE\t34149\n2020-10-24\tUS\t224889\n2020-10-24\tIN\t118534\n2020-10-24\tBR\t156903\n2020-10-24\tRU\t25647\n2020-10-24\tFR\t34536\n2020-10-24\tAR\t28613\n2020-10-24\tES\t34752\n2020-10-24\tCO\t30000\n2020-10-24\tMX\t88743\n2020-10-24\tPE\t34033\n2020-10-23\tUS\t223975\n2020-10-23\tIN\t117956\n2020-10-23\tBR\t156471\n2020-10-23\tRU\t25353\n2020-10-23\tFR\t34536\n2020-10-23\tAR\t28338\n2020-10-23\tES\t34752\n2020-10-23\tCO\t29802\n2020-10-23\tMX\t88312\n2020-10-23\tPE\t33984\n2020-10-27\tUS\t226691\n2020-10-27\tIN\t119502\n2020-10-27\tBR\t157946\n2020-10-27\tRU\t26409\n2020-10-27\tFR\t35582\n2020-10-27\tES\t35298\n2020-10-27\tAR\t29730\n2020-10-27\tCO\t30565\n2020-10-27\tGB\t45455\n2020-10-27\tMX\t89814\n2020-10-26\tUS\t225706\n2020-10-26\tIN\t119502\n2020-10-26\tBR\t157397\n2020-10-26\tRU\t26092\n2020-10-26\tFR\t35052\n2020-10-26\tAR\t29301\n2020-10-26\tES\t35031\n2020-10-26\tCO\t30348\n2020-10-26\tGB\t45088\n2020-10-26\tMX\t89171\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1604099404122_-2074379465","id":"20201030-231004_1268377483","dateCreated":"2020-10-30T23:10:04+0000","dateStarted":"2020-10-30T23:32:00+0000","dateFinished":"2020-10-30T23:32:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4666"},{"text":"%sql\nselect day, country, numberofcovidtweetsretrieved tweets from (\n    select *, row_number() OVER (PARTITION BY day ORDER BY confirmed DESC, numberofcovidtweetsretrieved DESC) rn from final\n)\nwhere rn <= 10","user":"anonymous","dateUpdated":"2020-10-30T23:32:28+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":779.267,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"country":"string","day":"string","numberofcovidtweetsretrieved":"string","confirmed":"string","deaths":"string","recovered":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","lineWithFocus":true,"isDateFormat":false,"forceY":true}},"commonSetting":{},"keys":[{"name":"day","index":0,"aggr":"sum"}],"groups":[{"name":"country","index":1,"aggr":"sum"}],"values":[{"name":"tweets","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"day\tcountry\ttweets\n2020-10-29\tUS\t970\n2020-10-29\tIN\t157\n2020-10-29\tBR\t39\n2020-10-29\tRU\t3\n2020-10-29\tFR\t238\n2020-10-29\tES\t218\n2020-10-29\tAR\t75\n2020-10-29\tCO\t62\n2020-10-29\tGB\t279\n2020-10-29\tMX\t149\n2020-10-28\tUS\t1153\n2020-10-28\tIN\t145\n2020-10-28\tBR\t51\n2020-10-28\tRU\t7\n2020-10-28\tFR\t299\n2020-10-28\tES\t191\n2020-10-28\tAR\t74\n2020-10-28\tCO\t50\n2020-10-28\tGB\t285\n2020-10-28\tMX\t151\n2020-10-25\tUS\t977\n2020-10-25\tIN\t196\n2020-10-25\tBR\t39\n2020-10-25\tRU\t1\n2020-10-25\tFR\t127\n2020-10-25\tAR\t69\n2020-10-25\tES\t272\n2020-10-25\tCO\t46\n2020-10-25\tMX\t86\n2020-10-25\tPE\t11\n2020-10-24\tUS\t970\n2020-10-24\tIN\t146\n2020-10-24\tBR\t46\n2020-10-24\tRU\t2\n2020-10-24\tFR\t153\n2020-10-24\tAR\t56\n2020-10-24\tES\t208\n2020-10-24\tCO\t39\n2020-10-24\tMX\t99\n2020-10-24\tPE\t7\n2020-10-23\tUS\t1190\n2020-10-23\tIN\t140\n2020-10-23\tBR\t34\n2020-10-23\tRU\t4\n2020-10-23\tFR\t178\n2020-10-23\tAR\t89\n2020-10-23\tES\t221\n2020-10-23\tCO\t40\n2020-10-23\tMX\t175\n2020-10-23\tPE\t11\n2020-10-27\tUS\t1083\n2020-10-27\tIN\t141\n2020-10-27\tBR\t49\n2020-10-27\tRU\t6\n2020-10-27\tFR\t211\n2020-10-27\tES\t194\n2020-10-27\tAR\t94\n2020-10-27\tCO\t41\n2020-10-27\tGB\t268\n2020-10-27\tMX\t163\n2020-10-26\tUS\t1001\n2020-10-26\tIN\t140\n2020-10-26\tBR\t43\n2020-10-26\tRU\t4\n2020-10-26\tFR\t148\n2020-10-26\tAR\t61\n2020-10-26\tES\t215\n2020-10-26\tCO\t44\n2020-10-26\tGB\t215\n2020-10-26\tMX\t122\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1604099425577_1488688236","id":"20201030-231025_717794182","dateCreated":"2020-10-30T23:10:25+0000","dateStarted":"2020-10-30T23:32:02+0000","dateFinished":"2020-10-30T23:32:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4667"},{"text":"%pyspark\ndf3.repartition(1).write.mode(\"append\").option(\"path\", output_path).format(\"Parquet\").saveAsTable(output_table)\nprint(\"Wrote the output!\")","user":"anonymous","dateUpdated":"2020-10-30T23:15:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1604098223627_-214100729","id":"20201030-225023_1904602597","dateCreated":"2020-10-30T22:50:23+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:4668"}],"name":"ETL","id":"2FPWM3SNA","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}